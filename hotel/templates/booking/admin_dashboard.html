{% extends 'base.html' %}
{% load django_bootstrap5 %}

{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ì–æ—Å—Ç–∏–Ω–∏—Ü–∞{% endblock %}

{% block page_title %}üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è{% endblock %}

{% block content %}
<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="card text-white bg-primary">
      <div class="card-body">
        <h4 class="card-title">{{ stats.total_bookings }}</h4>
        <p class="card-text">–í—Å–µ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-white bg-success">
      <div class="card-body">
        <h4 class="card-title">{{ stats.active_bookings }}</h4>
        <p class="card-text">–ê–∫—Ç–∏–≤–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-white bg-warning">
      <div class="card-body">
        <h4 class="card-title">{{ stats.today_check_ins }}</h4>
        <p class="card-text">–ó–∞–µ–∑–¥—ã —Å–µ–≥–æ–¥–Ω—è</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-white bg-info">
      <div class="card-body">
        <h4 class="card-title">{{ stats.today_check_outs }}</h4>
        <p class="card-text">–í—ã–µ–∑–¥—ã —Å–µ–≥–æ–¥–Ω—è</p>
      </div>
    </div>
  </div>
</div>

<!-- –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–µ–∑–¥—ã -->
{% if upcoming_checkins %}
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">üìÖ –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–µ–∑–¥—ã</h5>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–ù–æ–º–µ—Ä</th>
                <th>–î–∞—Ç–∞ –∑–∞–µ–∑–¥–∞</th>
                <th>–ù–æ—á–µ–π</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
              </tr>
            </thead>
            <tbody>
              {% for booking in upcoming_checkins %}
              <tr>
                <td>#{{ booking.id }}</td>
                <td>{{ booking.client.first_name }} {{ booking.client.last_name }}</td>
                <td>{{ booking.room.number }}</td>
                <td>{{ booking.check_in_date }}</td>
                <td>{{ booking.nights }}</td>
                <td>
                  <a href="{% url 'booking_detail' booking.pk %}" class="btn btn-sm btn-outline-primary">
                    –£–ø—Ä–∞–≤–ª—è—Ç—å
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- –¢–µ–∫—É—â–∏–µ –≥–æ—Å—Ç–∏ -->
{% if current_guests %}
<div class="row mb-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">üè® –¢–µ–∫—É—â–∏–µ –≥–æ—Å—Ç–∏</h5>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–ù–æ–º–µ—Ä</th>
                <th>–î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞</th>
                <th>–ó–∞—Å–µ–ª–µ–Ω</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
              </tr>
            </thead>
            <tbody>
              {% for booking in current_guests %}
              <tr>
                <td>#{{ booking.id }}</td>
                <td>{{ booking.client.first_name }} {{ booking.client.last_name }}</td>
                <td>{{ booking.room.number }}</td>
                <td>{{ booking.check_out_date }}</td>
                <td>
                  {% if booking.actual_check_in %}
                  {{ booking.actual_check_in|date:"d.m.Y H:i" }}
                  {% else %}
                  <span class="text-warning">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
                  {% endif %}
                </td>
                <td>
                  <a href="{% url 'booking_detail' booking.pk %}" class="btn btn-sm btn-outline-primary">
                    –£–ø—Ä–∞–≤–ª—è—Ç—å
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">üïê –ü–æ—Å–ª–µ–¥–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h5>
      </div>
      <div class="card-body">
        {% if recent_bookings %}
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–ù–æ–º–µ—Ä</th>
                <th>–î–∞—Ç—ã</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
              </tr>
            </thead>
            <tbody>
              {% for booking in recent_bookings %}
              <tr>
                <td>‚Ññ{{ booking.id }}</td>
                <td>{{ booking.client.first_name }} {{ booking.client.last_name }}</td>
                <td>{{ booking.room.number }}</td>
                <td>
                  {{ booking.check_in_date }} - {{ booking.check_out_date }}<br>
                  <small>{{ booking.nights }} –Ω–æ—á–µ–π</small>
                </td>
                <td>
                  <span class="booking-status status-{{ booking.status }}">
                    {{ booking.get_status_display }}
                  </span>
                </td>
                <td>
                  <a href="{% url 'booking_detail' booking.pk %}" class="btn btn-sm btn-outline-primary">
                    –£–ø—Ä–∞–≤–ª—è—Ç—å
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <div class="alert alert-info text-center">
          <h5>üìù –ü–æ–∫–∞ –Ω–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</h5>
          <p class="mb-3">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
          <a href="{% url 'booking_create' %}" class="btn btn-primary">
            ‚ûï –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
          </a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="card-title mb-0">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-3 mb-2">
            <a href="{% url 'booking_list' %}" class="btn btn-outline-primary w-100">
              üìã –í—Å–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
            </a>
          </div>
          <div class="col-md-3 mb-2">
            <a href="{% url 'booking_create' %}" class="btn btn-outline-success w-100">
              ‚ûï –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            </a>
          </div>
          <div class="col-md-3 mb-2">
            <a href="/admin/booking/room/" class="btn btn-outline-secondary w-100">
              üè® –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞–º–∏
            </a>
          </div>
          <div class="col-md-3 mb-2">
            <a href="/admin/booking/price/" class="btn btn-outline-warning w-100">
              üí∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–µ–Ω
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}